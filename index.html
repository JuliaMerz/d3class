<html>
  <head>
    <title>Top Stackexchange Questions</title>
    <link rel="stylesheet" href="styles.css">
    <script src="static/d3/d3.js"></script>
    <script src="static/jquery/dist/jquery.js"></script>
    <script src="static/stackquery.js"></script>
    <script src="static/underscore/underscore.js"></script>
    <meta http-equiv="content-type" content="text/html; charset=UTF8">
  </head>
  <body>
    <div id="body">
      <h1>
        Top Stackexchange Questions
      </h1>
      <div id="content">
        <div id="form">
          <form action="#">
            <input id="search-text" type="text" name="text">
            <input id="submit-button" type="submit" name="search">
          </form>
        </div>
        <div id="graph">
        </div>
        <div id="table">
          <table>
          </table>
        </div>
      </div>
    </div>
    <script>
      $( document ).ready(function() {
        $('#submit-button').on('click', buttonSubmit);
      });
      function buttonSubmit(e){
        e.preventDefault();
        stackquery($('#search-text').val(), grapher)
      }

      function grapher(data){
        console.log("raw data", data);


        //Make the table.
        var table = d3.select("table");
        rows = table.selectAll('tr')
            .data(data.items)
            .enter()
            .append('tr')
            .append('td');
        console.log(rows);
        rows.html(function(d, i){
          var result = '<a href="'+d.link+'">';
          result += d.title;
          result += '</a>';
          result += '<br>';
          for(var j=0; j<d.tags.length;j++){
            result += d.tags[j];
            result += ', ';
          }
          result += '<hr>';
          return result;

        });



        //Graph the top 10!
        var top = top10(data);

      }

    </script>
  </body>
</html>
